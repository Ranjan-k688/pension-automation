<!DOCTYPE html>
<html lang="en">
<head>
<title>Admin</title>  
<meta charset="utf-8"> 
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="shortcut icon" href="images/ru_logo.png" type="image/x-icon">
<link rel="icon" href="images/ru_logo.png" type="image/x-icon"> 

<link rel="stylesheet" href="css/bootstrap.min.css">
<link rel="stylesheet" href="css/bootstrap-select.min.css"> 
<link rel="stylesheet" href="css/bootstrap-datepicker.min.css">
<link rel="stylesheet" href="css/toastr.min.css">
<link rel="stylesheet" href="css/style.css"> 
<!-- <link rel="stylesheet" href="css/aos.css"> -->

<link rel="stylesheet" href="css/bootstrap-select.min.css">
<script src="js/angular.min.js"></script>
<script src="js/angular-route.js"></script>
<script src="js/jquery.min.js"></script>
<script src="js/bootstrap.min.js"></script> 
<script src="js/bootstrap-select.min.js"></script> 
<script src="js/bootstrap-datepicker.min.js"></script>
<script src="js/aos.js"></script>
<script src="js/toastr.min.js"></script>
<script src="js/jquery.table2excel.js"></script>
<script src="js/path.js"></script>
<script src="js/ui-bootstrap-tpls-0.3.0.min.js"></script>
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" /> 
<!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.css">
<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/daterangepicker@3.1.0/daterangepicker.css" /> -->

<!-- <link href="css/font-awesome.min.css" rel="stylesheet" />  -->
<link rel="stylesheet" href="css/toastr.min.css">
<link rel="stylesheet" type="text/css" href="css/daterangepicker.css" />

<!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.4/xlsx.full.min.js"></script> 
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/daterangepicker@3.1.0/moment.min.js"></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/daterangepicker@3.1.0/daterangepicker.js"></script>
<script src="https://cdn.rawgit.com/danialfarid/ng-file-upload/master/dist/ng-file-upload.min.js"></script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.1.4/Chart.bundle.min.js'></script>
<script src='https://canvasjs.com/assets/script/canvasjs.min.js'></script>-->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.3/jspdf.umd.min.js"></script> 


<script src="js/toastr.min.js"></script>
<script src="js/xlsx.full.min.js"></script> 
<script type="text/javascript" src="js/moment.min.js"></script>
<script type="text/javascript" src="js/daterangepicker.js"></script>
<script src="js/ng-file-upload.min.js"></script>
<script src='js/Chart.bundle.min.js'></script>
<script src='js/canvasjs.min.js'></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.3/jspdf.umd.min.js"></script>



<style>
  .bootstrap-select>.dropdown-toggle{height: 34px;}
  .incpage{display: flex; width: 100%;}
  .lists{
      text-align: center;
      font-size: 20px;
      color: rgb(16, 16, 16);
      font-weight: 700;
  }
  .success-message {
  position: absolute;
  top: 20px; /* Adjust the top position as needed */
  right: 20px; /* Adjust the right position as needed */
  background-color: #4CAF50; /* Green color */
  color: #fff; /* White text color */
  padding: 10px;
  border-radius: 5px;
  
}
.delete-message {
  position: absolute;
  top: 20px; /* Adjust the top position as needed */
  right: 20px; /* Adjust the right position as needed */
  background-color: #4CAF50; /* Green color */
  color: #fff; /* White text color */
  padding: 10px;
  border-radius: 8px;
  
}
.modal-backdrop{display: none!important;}
.popupbg{position: fixed; width: 100%; height: 100%; background: rgba(0,0,0,0.5); left: 0; top: 0; display: none;     z-index: 2;}

.dtlist {
            list-style: none;
            padding: 0;
            margin: 0;
            max-height: 450px;
            overflow: auto;
            display: flex;
            align-items: center;
            flex-wrap: wrap
        }

        .dtlist>li {
            width: 50%;
            padding: 10px;
            font-size: 14px
        }

        .dtlist>li span {
            font-family: "Roboto", Helvetica, Arial, sans-serif;
            display: inline-block;
            min-width: 150px;
            text-transform: capitalize;
            font-weight: 600
        }

        .close-button {
            position: absolute;
            top: 10px;
            right: 10px;
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #555
        }

        .close-button:hover {
            color: #000
        }

      

        #detailmodal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 9999;
            min-width: 100px
        }

        #detailmodal-content {
            top: 50px;
            background-color: #fff;
            padding: 20px;
            border-radius: 5px;
            position: relative;
            box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.5);
            max-width: 880px;
            margin: auto;
            overflow: hidden
        }

        #detailmodal h2 {
            font-size: 24px;
            margin-bottom: 10px;
            margin-top: 0;
            font-weight: 600;
            font-family: roboto
        }

        #detailmodal-content .row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 5px 0;
            border-bottom: 1px solid #ccc
        }

        #detailmodal-content .row:last-child {
            border-bottom: none
        }

        #detailmodal-content .row span {
            font-weight: bold;
            text-transform: capitalize
        }
        .mybtn{padding: 5px 12px;}

        .tooltip-inner{background-color: var(--dark-blue);} 
      .tooltip.top .tooltip-arrow{border-top-color:var(--dark-blue);}
.flexbox{display: flex;}
.logoutbtn{display: flex; align-items: center; margin-left: 15px; background:#c5e8ff ; color: var(--dark-blue); border-radius:5px; padding:5px 10px; }
.logoutbtn img{max-height: 24px;filter: brightness(100); margin-right: 5px; font-weight: bold;}


.popsec{position: relative;}
.popbox { display: none; position: absolute; right:-10px; top:52px; z-index: 999; text-align: center; border-radius: 10px; background: #dae7fb; width: 300px; padding:15px;}
.popbox:after {bottom: 100%;	right: 20px;	border: solid transparent;	content: "";	height: 0;	width: 0;	position: absolute;
	pointer-events: none;	border-color: rgba(218, 231, 251, 0);	border-bottom-color: #dae7fb;	border-width: 10px;	margin-left: -10px;}
.userimg{ width: 120px; height: 120px; margin: 10px auto; background: var(--white); border: 3px solid var(--white); border-radius:50%; overflow: hidden;} 
.userimg img{width: 100%; height: 100%; object-fit: cover; }
.username{font-size: 18px; font-weight: 600; }
.popbox .logoutbtn {   background: var(--white);  color: var(--dark-blue);   width: 106px;  margin: 10px auto 0; font-weight: 600;}
.idsec{display: flex; justify-content: center;}
.idsec span{margin:0 5px; padding:2px 10px; background: var(--white); border-radius: 4px;}
.popbox .close{font-size: 30px; font-weight: normal;}

.links.submenu{position: relative;}
.links.submenu::after{content: "+"; position: absolute; right: 10px; font-size: 20px;font-weight:bold;}
.active .links.submenu::after{content: "-";}
.sidelink ul li.active > ul{max-height: 280px;}
.leftmenu.active{width:50px}
.leftmenu.active span{display:none;}
.contentsection.active{width: calc(100% - 50px);}
</style>
</head>
<!-- id="mainctrl" -->
<body ng-app="app" ng-controller="mainCtrl">
 
<section class="mainsection"> 
  <div class="pagesection">  
    <div class="topheading">
      <div class="logo">
        <img src="images/ru_logo.png" alt="RU">
    <div>
    <u>राँची विश्‍वविद्यालय</u><span>Ranchi University</span> 
    </div>
    <!-- <div><span ng-click="showleftmenu()">=</span></div> -->
      </div> 
      <div class="flexbox popsec">
        <a class="userlogin" ng-click="showuserpop()">{{userFullName}}<span><img ng-src="{{ profile_image!='null' ? 'https://ru-pension-attachment.s3.ap-south-1.amazonaws.com/profile_images/' + profile_image : 'images/users.jpg' }}" alt="student" /></span></a>
        <!-- <a class="logoutbtn" ng-click="logout()"><img src="images/logout.png" alt="Logout" /> Log Out </a> -->
        <div class="popbox" id="userpop">
          <button type="button" class="close" data-dismiss="modal" ng-click="closeuserpop()">&times;</button>
          <div class="userimg"><img ng-src="{{ profile_image!='null' ? 'https://ru-pension-attachment.s3.ap-south-1.amazonaws.com/profile_images/' + profile_image : 'images/users.jpg' }}" alt="user" /></div>
          
          <div class="username">{{userFullName}}</div>
          <div class="idsec"><span>{{emailId}}</span> <span>{{mobileNo}}</span></div>
          <div><a class="logoutbtn" ng-click="logout()"><img src="images/logout.png" alt="Logout" /> Log Out </a></div>
        </div>
      </div>  
    </div>
  <div class="mainbox">
    <div class="leftmenu" ng-class="{active: showhidemenu}"> 
      <div class="sidelink scrollbar-primary">
          <ul class="sidebar-menu">
          <li class="menulink" ng-repeat="menuItem in menuItems | orderBy:'parseInt(menuItem.seq_no)'" ng-class="{active: link === menuItem.link}">
            <a class="links" ng-click="handleLink(menuItem.link)">
              <i class="fa {{menuItem.icon}}"></i> <span>{{menuItem.label}}</span>
            </a>
          </li>
          <li class="menulink" ng-if="master" ng-class="{active: !['dashboard','generate-advice','bank-advice','dependent_pId_gen','die_in_harness','userId_pen','userId_emp','pensioner-checker','dashboard', 'pensioner_form', 'pensioner_report', 'generate-pension', 'forwarded', 'verifier', 'disburser', 'monthly-pension', 'list_pensioner', 'generate-pension-id', 'application-user'].includes(link)}">
            <a class="links submenu" > <i class="fa fa-file-archive-o"></i> <span>Master Data Entry</span> </a>
                <ul class="sub-menu scrollbar scrollbar-primary">
                  <li ng-repeat="submenuItem in submenuItems | orderBy:'parseInt(submenuItem.seq_no)'" ng-class="{active: link === submenuItem.link}">
                    <a class="links" ng-click="handleSubLink(submenuItem.link)">
                      <i class="fa {{submenuItem.icon}}"></i> <span>{{submenuItem.label}}</span>
                    </a>
                  </li>
                </ul>
            </li>
          
          </ul>
      </div>
  </div>

    <div class="contentsection" ng-include="templateUrl" ng-class="{active: showhidemenu}"></div>
    
  </div>

  <div class="loaderbg" >
    <div class="loading">
      Loading
    <span class="loading-dots">.</span>
    <span class="loading-dots">.</span>
    <span class="loading-dots">.</span>
  </div>
  </div>
  </section>


  <script>

      setTimeout(function(){
        $('[data-tooltip="tooltip"]').tooltip();   
        
      },2000);


    $(document).on("click", function (event) {
      if (!$(event.target).closest('.datepicker').length) {
        $('.datepicker').datepicker({
          // format: "yyyy-mm-dd",
          format: "dd-mm-yyyy",
          autoclose: true
        });
      }
    });
         
    
    $(document).ready(function () { 
      AOS.init();

      $(".close").click(function(){
      $('.popupbg').hide();
      });

      $( "body" ).click(function() {
    $('.popbox').hide();
  }); 
  
  $( ".popsec" ).click(function(e) {
    e.stopPropagation();
  });


     $(".submenu").click(function(){
      $('.sidelink li').removeClass('active');
    $(this).parent().addClass('active');
    });
    }); 
    </script>
    

    <script type="text/javascript"> 
      var app = angular.module('app', ['ngFileUpload','ui.bootstrap']);

      app.directive('datepicker', function () {
        return {
            restrict: 'A',
            require: 'ngModel',
            link: function (scope, element, attrs, ngModelCtrl) {
                $(element).datepicker({
                    autoclose: true,
                    todayHighlight: true,
                    format: 'dd-mm-yyyy',
                    endDate: new Date() // Set the maximum date to the current date
                }).on('changeDate', function (e) {
                    scope.$apply(function () {
                        var selectedDate = e.date;
                        var currentDate = new Date();

                        // Check if the selected date is in the future
                        if (selectedDate <= currentDate) {
                            ngModelCtrl.$setViewValue(e.format());
                        } else {
                            // Optionally, you can handle the case of selecting a future date
                            // For example, show an alert or set the value to the current date
                            alert('Please select a date on or before today.');
                            ngModelCtrl.$setViewValue(currentDate);
                        }
                    });
                });
            }
        };
    });

app.directive('newDatepicker', function () {
    return {
        restrict: 'A',
        require: 'ngModel',
        link: function (scope, element, attrs, ngModelCtrl) {
            $(element).datepicker({
                autoclose: true,
                todayHighlight: true,
                format: 'dd-mm-yyyy',
                endDate: new Date(new Date().setFullYear(new Date().getFullYear() - 60)) // Set the maximum date to the current date
            }).on('changeDate', function (e) {
                scope.$apply(function () {
                    var selectedDate = e.date;
                    var currentDate = new Date();

                    // Check if the selected date is in the future
                    if (selectedDate <= currentDate) {
                        ngModelCtrl.$setViewValue(e.format());
                    } else {
                        // Optionally, you can handle the case of selecting a future date
                        // For example, show an alert or set the value to the current date
                        alert('Please select a date on or before today.');
                        ngModelCtrl.$setViewValue(currentDate);
                    }
                });
            });
        }
    };
});

app.directive('newDatepicker18', function () {
    return {
        restrict: 'A',
        require: 'ngModel',
        link: function (scope, element, attrs, ngModelCtrl) {
            var maxDate = new Date();
            maxDate.setFullYear(maxDate.getFullYear() - 18); // Set the maximum date to 18 years ago

            $(element).datepicker({
                autoclose: true,
                todayHighlight: true,
                format: 'dd-mm-yyyy',
                endDate: maxDate
            }).on('changeDate', function (e) {
                scope.$apply(function () {
                    var selectedDate = e.date;
                    var currentDate = new Date();

                    // Check if the selected date is 18 years or more in the past
                    if (currentDate.getFullYear() - selectedDate.getFullYear() >= 18) {
                        ngModelCtrl.$setViewValue(e.format());
                    } else {
                        // Optionally, you can handle the case of selecting a date less than 18 years ago
                        // For example, show an alert or set the value to 18 years ago
                        alert('Please select a date that is 18 years or more in the past.');
                        ngModelCtrl.$setViewValue(maxDate);
                    }
                });
            });
        }
    };
});




      app.directive('yearPicker', function () {
    return {
        restrict: 'A',
        require: 'ngModel',
        link: function (scope, element, attrs, ngModelCtrl) {
            $(element).datepicker({
                format: 'yyyy',
                viewMode: 'years',
                minViewMode: 'years',
                autoclose: true,
                endDate: new Date() // Set the maximum date to the current date
            }).on('changeDate', function (e) {
                scope.$apply(function () {
                    var selectedYear = e.date.getFullYear();
                    var currentYear = new Date().getFullYear();

                    // Check if the selected year is in the future
                    if (selectedYear <= currentYear) {
                        ngModelCtrl.$setViewValue(e.format());
                    } else {
                        // Optionally, you can handle the case of selecting a future year
                        // For example, show an alert or set the value to the current year
                        alert('Please select a year in the past or the current year.');
                        ngModelCtrl.$setViewValue(currentYear);
                    }
                });
            });
        }
    };
});

          app.directive('panNumber', () => ({
              require: 'ngModel',
              link: (scope, element, attrs, ngModelCtrl) => {
                ngModelCtrl.$parsers.push((text) => {
                  const panRegex = /^[A-Z]{5}[0-9]{4}[A-Z]$/;
                  text = text.replace(/[!@#$%^&*+\s]/g, '');
                  const specialCharRegex = /[!@#$%^&*+\s]/;
                  const startsWithSpaceRegex = /^\s/;
                  ngModelCtrl.$setValidity('panNumber', !specialCharRegex.test(text) && !startsWithSpaceRegex.test(text) && panRegex.test(text));

                  return text;
                });
              }
            }));


            app.directive('noSpecialCharacters', () => ({
                restrict: 'A',
                require: 'ngModel',
                link: (scope, element, attr, ngModelCtrl) => {
                  element.on('input', () => {
                    const value = element.val().replace(/[^a-zA-Z0-9]/g, '');
                    ngModelCtrl.$setViewValue(value);
                    ngModelCtrl.$render();
                  });
                }
              }));


          app.directive('mCapitalize', input);
            function input() {
              return { require : 'ngModel',
                link : function(scope, element, attr, ngModelCtrl) {
                  function fromUser(text) {
                    if(text){
                      text=text.toUpperCase();	
                    }
                    ngModelCtrl.$setViewValue(text);
                    ngModelCtrl.$render();
                    return text;
                  }
                  ngModelCtrl.$parsers.push(fromUser);
                } };
            };


          // app.directive('myDateRangePicker', function() {
          //   return {
          //     restrict: 'A',
          //     require: 'ngModel',
          //     link: function(scope, element, attrs, ngModelCtrl) {
          //       $(element).daterangepicker(
          //         {},
          //         function (start, end, label) {
          //           scope.$apply(function () {
          //             ngModelCtrl.$setViewValue({ start: start, end: end });
          //           });
          //         }
          //       );
          //     }
          //   };
          // });
          app.directive('myDateRangePicker', function () {
            return {
                restrict: 'A',
                require: 'ngModel',
                link: function (scope, element, attrs, ngModelCtrl) {
                    $(element).daterangepicker({
                        opens: 'left', // You can customize the opening side (left or right)
                        autoApply: true, // Automatically apply the selected date range
                        showDropdowns: true, // Show year and month dropdowns
                        linkedCalendars: false, // Allow selecting a date range that spans two months
                        locale: {
                            format: 'DD-MM-YYYY' // Set the desired date format
                        },
                        maxDate: moment() // Restrict to the current date and earlier
                    }, function (start, end, label) {
                        scope.$apply(function () {
                            ngModelCtrl.$setViewValue({ start: start.format('DD-MM-YYYY'), end: end.format('DD-MM-YYYY') });
                        });
                    });
                }
            };
        });






          app.directive('mName', function() {
            return {
              restrict: 'A',
              require: 'ngModel',
              link: function(scope, element, attr, ngModelCtrl) {
                element.on('input', function() {
                  var value = element.val();
                  value = value.replace(/[0-9!@#$%^&*+]/g, '');
                  value = value.replace(/(\s{2,})|[^a-zA-Z\-.@']/g, ' ');
                  value = value.replace(/^\s*/, '');
                  value = value.replace(/\b\w/g, function(l) {
                    return l.toUpperCase();
                  });
                  ngModelCtrl.$setViewValue(value);
                  ngModelCtrl.$render();
                });
              }
            };
          });

          app.directive('mNumOnly', onlyDigitInput);
          function onlyDigitInput() {
            return { 
              restrict: 'A',
                require: 'ngModel',
                link: function (scope, element, attr, ngModelCtrl) {
                    function fromUser(text) {
                        if (text) {
                            var transformedInput = text.replace(/[^0-9-]/g, '');
                            if (transformedInput !== text) {
                                ngModelCtrl.$setViewValue(transformedInput);
                                ngModelCtrl.$render();
                            }
                            return transformedInput;
                        }
                        return undefined;
                    }
                    ngModelCtrl.$parsers.push(fromUser);
                }
            };
          };

              angular.module('app').filter('indianNumber', function () {
                  return function (input) {
                      if (!input) return '';

                      var num = input.toString().split('.');
                      var lastThree = num[0].substring(num[0].length - 3);
                      var otherNumbers = num[0].substring(0, num[0].length - 3);
                      if (otherNumbers != '') {
                          lastThree = ',' + lastThree;
                      }
                      var output = otherNumbers.replace(/\B(?=(\d{2})+(?!\d))/g, ",") + lastThree;

                      if (num.length > 1) {
                          output += "." + num[1];
                      }

                      return output;
                  };
              });

          app.directive('monthYearPicker', function () {
          return {
            restrict: 'A',
            require: 'ngModel',
            link: function (scope, element, attrs, ngModelCtrl) {
              element.attr('type', 'month');

              element.on('input', function (e) {
                scope.$apply(function () {
                  ngModelCtrl.$setViewValue(new Date(e.target.value + '-01'));
                });
              });
            }
          };
        });


        app.filter('unique', function() {
    return function(items, filterOn) {
        if (filterOn === false) {
            return items;
        }
        
        if ((filterOn || angular.isUndefined(filterOn)) && angular.isArray(items)) {
            var hashCheck = {}, newItems = [];
            var extractValueToCompare = function(item) {
                if (angular.isObject(item) && angular.isString(filterOn)) {
                    return item[filterOn];
                } else {
                    return item;
                }
            };
            
            angular.forEach(items, function(item) {
                var valueToCheck, isDuplicate = false;
                
                for (var i = 0; i < newItems.length; i++) {
                    if (angular.equals(extractValueToCompare(newItems[i]), extractValueToCompare(item))) {
                        isDuplicate = true;
                        break;
                    }
                }
                
                if (!isDuplicate) {
                    newItems.push(item);
                }
            });
            items = newItems;
        }
        return items;
    };
});


    app.service('sharedService', function() {
          var service = this;

          service.compareDates = function(date1, date2) {
            var d1 = new Date(date1.split('-').reverse().join('-'));
            var d2 = new Date(date2.split('-').reverse().join('-'));

              // Compare dates
              if (d1 < d2) {
                return 1;
              } else if (d1 > d2) {
                return -1;
              } else {
                return 0; // Dates are equal
              }
        };
        service.getMonthName = function(monthNumber) {
      var months = [
        "January", "February", "March", "April", "May", "June",
        "July", "August", "September", "October", "November", "December"
      ];
    
      // Ensure the monthNumber is valid (between 1 and 12)
      if (monthNumber >= 1 && monthNumber <= 12) {
        return months[monthNumber - 1];
      } else {
        return "Invalid month number";
      }
    };
        });


        app.factory('numberToWordsService', function () {
            let thousands = ['', 'Thousand', 'Lakh', 'Crore'];
            let digits = ['Zero', 'One', 'Two', 'Three', 'Four', 'Five', 'Six', 'Seven', 'Eight', 'Nine'];
            let tens = ['Ten', 'Eleven', 'Twelve', 'Thirteen', 'Fourteen', 'Fifteen', 'Sixteen', 'Seventeen', 'Eighteen', 'Nineteen'];
            let twenties = ['Twenty', 'Thirty', 'Forty', 'Fifty', 'Sixty', 'Seventy', 'Eighty', 'Ninety'];


            function convertNumberToWords(number) {
                if (number === undefined || number === null) return 'invalid input';

                number = number.toString().replace(/[\, ]/g, '');
                if (isNaN(number)) return 'invalid input';

                let decimalIndex = number.indexOf('.');
                let fractionPart = decimalIndex !== -1 ? number.slice(decimalIndex + 1) : '';
                let wholePart = decimalIndex !== -1 ? number.slice(0, decimalIndex) : number;
                if (wholePart.length > 15) return 'too big';

                let word = convertWholePartToWords(wholePart);

                if (fractionPart) {
                    let fractionWords = convertFractionPartToWords(fractionPart);
                    word += ' and ' + fractionWords + ' Paisa Only.';
                } else {
                    word += ' Only';
                }

                return word.replace(/\s+/g, ' ').trim();
            }

            function convertWholePartToWords(num) {
                let word = '';
                let unitIndex = 0;

                while (num.length > 0) {
                    let chunkSize;
                    if (unitIndex === 1 || unitIndex === 2) { // handle thousands and lakhs
                        chunkSize = 2;
                    } else if (unitIndex === 3) { // handle crores
                        chunkSize = 2;
                    } else { // handle the hundreds place
                        chunkSize = 3;
                    }

                    let chunk = num.slice(-chunkSize);
                    num = num.slice(0, -chunkSize);

                    let chunkNumber = parseInt(chunk, 10);
                    if (chunkNumber > 0) {
                        if (unitIndex === 0) {
                            word = getWordsForChunk(chunkNumber) + ' ' + word;
                        } else {
                            word = getWordsForChunk(chunkNumber) + ' ' + thousands[unitIndex] + ' ' + word;
                        }
                    }
                    unitIndex++;
                }

                return word.trim();
            }

            function convertFractionPartToWords(num) {
                let fractionNumber = parseInt(num, 10);
                if (fractionNumber === 0) return '';
                return getWordsForChunk(fractionNumber);
            }

            function getWordsForChunk(chunkNumber) {
                let chunkWord = '';
                if (chunkNumber >= 100) {
                    chunkWord += digits[Math.floor(chunkNumber / 100)] + ' Hundred ';
                    chunkNumber = chunkNumber % 100;
                }
                if (chunkNumber >= 20) {
                    chunkWord += twenties[Math.floor(chunkNumber / 10) - 2] + ' ';
                    chunkNumber = chunkNumber % 10;
                }
                if (chunkNumber > 0 && chunkNumber < 10) {
                    chunkWord += digits[chunkNumber] + ' ';
                } else if (chunkNumber >= 10) {
                    chunkWord += tens[chunkNumber - 10] + ' ';
                }
                return chunkWord.trim();
            }

            // Expose the convertNumberToWords function as a service method
            return {
                convert: convertNumberToWords
            };
        });


      app.controller('mainCtrl', function ($scope,$http, $location, $timeout,$window,$rootScope) {
        $scope.master=false;
        // console.log($window.sessionStorage.getItem('pages'));
				const storedData = $window.sessionStorage.getItem("roles");
        $scope.menuItems = [];
        $scope.submenuItems = [];
        $scope.menuItems.push({ link: 'dashboard', icon: 'fa-desktop', label: 'Dashboard' , menu_level: 1 , seq_no: 1 });

				// Parse the stored string to an array of entries
				const storedEntries = JSON.parse(storedData);

				// Convert the array of entries back to a Map
				const retrievedMap = new Map(storedEntries);
        retrievedMap.forEach((values, keys) => {
          if(values.menuLabel=='1'){
            $scope.menuItems.push(values);
          }
          else if(values.menuLabel=='2'){
            $scope.submenuItems.push(values);
          }
            // console.log(values, keys);
            // console.log($scope.menuItems);
        });
        
       let token = $window.sessionStorage.getItem('token');
       $scope.userFullName = $window.sessionStorage.getItem('userFullName');
       $scope.profile_image = $window.sessionStorage.getItem('profile_image');
       $scope.emailId = $window.sessionStorage.getItem('emailId');
       $scope.mobileNo = $window.sessionStorage.getItem('mobileNo');
      if(sessionStorage.getItem('token')=='' || sessionStorage.getItem('token')==null){
      $window.location.href="index.html";
    } 

    $rootScope.logout = function() {
      // $window.sessionStorage.setItem('token', '');
      // $window.sessionStorage.setItem('userid', '');
      $window.sessionStorage.removeItem('token');
      $window.sessionStorage.removeItem('userid');
      $window.location.href = 'index.html';
    }

          $scope.masterrolecheck=function(){
            $scope.rolelist=[];
            $scope.rolelist=$window.sessionStorage.getItem('rolelist');
            var roleArray = $scope.rolelist.split(',');
            for(let i=0;i<=roleArray.length;i++){
              if(roleArray[i]=='RL-Master' || roleArray[i]=='RL-Admin'){
                    $scope.master=true
                          }
                      }
                    }
                    $scope.masterrolecheck();

        $scope.link = '';
        $scope.sublink = '';

        $rootScope.handleLink = function (pgname) {
          let found=false;
          retrievedMap.forEach((values, keys) => {
          if(values.link==pgname){
            $('.submenu').parent().removeClass('active');
          $scope.templateUrl = 'view/' + pgname + '.html';
          $scope.link = pgname;
          $scope.sublink = '';
          $location.path('/' + pgname);
          // console.log('Handling link:', $scope.link);
          found=true;
          }
          else if(pgname==='dashboard'){
            $scope.templateUrl = 'view/dashboard.html';
            $scope.link = pgname;
          $scope.sublink = '';
          $location.path('/' + pgname);
          // console.log('Handling link:', $scope.link); 
          found=true;
          }
        });
          
        if (!found) {
        $scope.templateUrl = 'view/404.html';
    }
        };


      
       
        $scope.handleSubLink = function (sublink) {
          $scope.link = sublink;
           $scope.templateUrl = 'view/' + sublink + '.html';
           $location.path('/' + sublink);
        };
      
      
      $scope.linkurl = window.location.href.split("/")[window.location.href.split("/").length - 1];
      $scope.handleLinkFirstTime = function (pgname) {
        if(pgname==''||pgname==''||pgname=='landingpage.html'){
          pgname='dashboard';
        }
        $scope.handleLink(pgname);
        };
        $scope.handleLinkFirstTime($scope.linkurl);

        $scope.showuserpop = function (){
    $('#userpop').show();
  };
  $scope.closeuserpop = function (){
    $('#userpop').hide();
  };
  $scope.showhidemenu=false;
  $scope.showleftmenu=function(){
    $scope.showhidemenu = !$scope.showhidemenu;
  };
  
   // Function to be called on back button
  function onBackButton() {
    // Add your custom logic here
    console.log('Back button pressed');
    $scope.$apply(() => {
      // Update the template URL based on the new location path
      $scope.templateUrl = window.location.href.split("/")[window.location.href.split("/").length - 1];
      $scope.handleLink($scope.templateUrl);
    });
  }

  // Listen for the browser back button
  angular.element($window).on('popstate', onBackButton);

  // Clean up the event listener when the scope is destroyed
  $scope.$on('$destroy', function() {
    angular.element($window).off('popstate', onBackButton);
  });
  
      });


      </script>
      
      
      
      <script src="app/controller/dashboard_ctrl.js" type="text/javascript"></script>
        <script src="app/controller/age-vs-basic_ctrl.js" type="text/javascript"></script>
      <script src="app/controller/college_ctrl.js" type="text/javascript"></script>
      <script src="app/controller/college-type_ctrl.js" type="text/javascript"></script>
      <script src="app/controller/department_ctrl.js" type="text/javascript"></script>
      <script src="app/controller/dependents_ctrl.js" type="text/javascript"></script>
      <script src="app/controller/life-certificate_ctrl.js" type="text/javascript"></script>
      <script src="app/controller/pacommn-rate_ctrl.js" type="text/javascript"></script>
      <script src="app/controller/pay-commision_ctrl.js" type="text/javascript"></script>
      <script src="app/controller/pay-details_ctrl.js" type="text/javascript"></script>
      <script src="app/controller/pension-journal_ctrl.js" type="text/javascript"></script>
      <script  src="app/controller/pensioner_ctrl.js" type="text/javascript"></script>
      <script src="app/controller/pensionerdesignation_ctrl.js" type="text/javascript"></script>
      <script src="app/controller/pensionergrade_ctrl.js" type="text/javascript"></script>
      <script src="app/controller/pensionerstatus_ctrl.js" type="text/javascript"></script>
      <script src="app/controller/pensionerstatuslst_ctrl.js" type="text/javascript"></script>
      <script src="app/controller/pensionertype_ctrl.js" type="text/javascript"></script>
      <script src="app/controller/pensionstatus_ctrl.js" type="text/javascript"></script>
      <script src="app/controller/phy-handicapped_ctrl.js" type="text/javascript"></script>
      <script src="app/controller/life-certificate_ctrl.js" type="text/javascript"></script>
      <script src="app/controller/life-certificate-list_ctrl.js" type="text/javascript"></script>
      <script src="app/controller/relationship_ctrl.js" type="text/javascript"></script>
      <script src="app/controller/religion_ctrl.js" type="text/javascript"></script>
      <script src="app/controller/service-history_ctrl.js" type="text/javascript"></script>
      <script src="app/controller/subject_ctrl.js" type="text/javascript"></script>
      <script src="app/controller/university_ctrl.js" type="text/javascript"></script>
      <script src="app/controller/generate-pension_ctrl.js" type="text/javascript"></script>
      <script src="app/controller/pensioner-account_ctrl.js" type="text/javascript"></script>
      <script src="app/controller/monthly-pension_ctrl.js" type="text/javascript"></script>
      <script src="app/controller/application-user_ctrl.js" type="text/javascript"></script>
      <script src="app/controller/forwarded_ctrl.js" type="text/javascript"></script>
      <script src="app/controller/verifier_ctrl.js" type="text/javascript"></script>
      <script src="app/controller/disburser_ctrl.js" type="text/javascript"></script>
      <script src="app/controller/pay-commision-change_ctrl.js" type="text/javascript"></script>
      <script src="app/controller/pensioner_list_ctrl.js" type="text/javascript"></script>

      <script src="app/controller/userId_emp_ctrl.js" type="text/javascript"></script>
      <script src="app/controller/userId_pen_ctrl.js" type="text/javascript"></script>
      <script src="app/controller/dieInHarness_ctrl.js" type="text/javascript"></script>
      <script src="app/controller/dependent_pId_gen_ctrl.js" type="text/javascript"></script>
      <script src="app/controller/bank_advice_ctrl.js" type="text/javascript"></script>
      <script src="app/controller/hra-report_ctrl.js" type="text/javascript"></script>
      <script src="app/controller/tds_report_ctrl.js" type="text/javascript"></script>


      </body>
      </html >   